var be=Object.defineProperty;var ve=(m,f,b)=>f in m?be(m,f,{enumerable:!0,configurable:!0,writable:!0,value:b}):m[f]=b;var u=(m,f,b)=>(ve(m,typeof f!="symbol"?f+"":f,b),b);(function(){"use strict";const m={num_hexes_tall:10,num_hexes_wide:10,hexagon_edge_pixels:80,zoom_level:5,brush_id:"clear_path",hexagon_stroke_width:1},f={unset:"#FFFFFF",ocean:"#a5c6fa",mountain:"#9d9fa1",bog:"#ffe4fd",forest:"#a1e070",plains:"#ddfec3",desert:"#fae4a7",hills:"#d1d2d3",white:"#ffffff",black:"#000000",road:"#dc9e00",red:"#a83232",disabled:"#c2c2c2"};var b={},O={exports:{}},_={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y=Symbol.for("react.element"),H=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),G=Symbol.for("react.strict_mode"),W=Symbol.for("react.profiler"),J=Symbol.for("react.provider"),Y=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),X=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),C=Symbol.iterator;function ee(t){return t===null||typeof t!="object"?null:(t=C&&t[C]||t["@@iterator"],typeof t=="function"?t:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,T={};function v(t,e,r){this.props=t,this.context=e,this.refs=T,this.updater=r||j}v.prototype.isReactComponent={},v.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},v.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function D(){}D.prototype=v.prototype;function k(t,e,r){this.props=t,this.context=e,this.refs=T,this.updater=r||j}var S=k.prototype=new D;S.constructor=k,I(S,v.prototype),S.isPureReactComponent=!0;var F=Array.isArray,L=Object.prototype.hasOwnProperty,E={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function N(t,e,r){var i,o={},s=null,n=null;if(e!=null)for(i in e.ref!==void 0&&(n=e.ref),e.key!==void 0&&(s=""+e.key),e)L.call(e,i)&&!A.hasOwnProperty(i)&&(o[i]=e[i]);var l=arguments.length-2;if(l===1)o.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];o.children=c}if(t&&t.defaultProps)for(i in l=t.defaultProps,l)o[i]===void 0&&(o[i]=l[i]);return{$$typeof:y,type:t,key:s,ref:n,props:o,_owner:E.current}}function te(t,e){return{$$typeof:y,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function P(t){return typeof t=="object"&&t!==null&&t.$$typeof===y}function re(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var M=/\/+/g;function R(t,e){return typeof t=="object"&&t!==null&&t.key!=null?re(""+t.key):e.toString(36)}function x(t,e,r,i,o){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var n=!1;if(t===null)n=!0;else switch(s){case"string":case"number":n=!0;break;case"object":switch(t.$$typeof){case y:case H:n=!0}}if(n)return n=t,o=o(n),t=i===""?"."+R(n,0):i,F(o)?(r="",t!=null&&(r=t.replace(M,"$&/")+"/"),x(o,e,r,"",function(d){return d})):o!=null&&(P(o)&&(o=te(o,r+(!o.key||n&&n.key===o.key?"":(""+o.key).replace(M,"$&/")+"/")+t)),e.push(o)),1;if(n=0,i=i===""?".":i+":",F(t))for(var l=0;l<t.length;l++){s=t[l];var c=i+R(s,l);n+=x(s,e,r,c,o)}else if(c=ee(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=i+R(s,l++),n+=x(s,e,r,c,o);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return n}function g(t,e,r){if(t==null)return t;var i=[],o=0;return x(t,i,"","",function(s){return e.call(r,s,o++)}),i}function ie(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var a={current:null},w={transition:null},oe={ReactCurrentDispatcher:a,ReactCurrentBatchConfig:w,ReactCurrentOwner:E};_.Children={map:g,forEach:function(t,e,r){g(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return g(t,function(){e++}),e},toArray:function(t){return g(t,function(e){return e})||[]},only:function(t){if(!P(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},_.Component=v,_.Fragment=B,_.Profiler=W,_.PureComponent=k,_.StrictMode=G,_.Suspense=Q,_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oe,_.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=I({},t.props),o=t.key,s=t.ref,n=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,n=E.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)L.call(e,c)&&!A.hasOwnProperty(c)&&(i[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)i.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];i.children=l}return{$$typeof:y,type:t.type,key:o,ref:s,props:i,_owner:n}},_.createContext=function(t){return t={$$typeof:Y,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:J,_context:t},t.Consumer=t},_.createElement=N,_.createFactory=function(t){var e=N.bind(null,t);return e.type=t,e},_.createRef=function(){return{current:null}},_.forwardRef=function(t){return{$$typeof:K,render:t}},_.isValidElement=P,_.lazy=function(t){return{$$typeof:Z,_payload:{_status:-1,_result:t},_init:ie}},_.memo=function(t,e){return{$$typeof:X,type:t,compare:e===void 0?null:e}},_.startTransition=function(t){var e=w.transition;w.transition={};try{t()}finally{w.transition=e}},_.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},_.useCallback=function(t,e){return a.current.useCallback(t,e)},_.useContext=function(t){return a.current.useContext(t)},_.useDebugValue=function(){},_.useDeferredValue=function(t){return a.current.useDeferredValue(t)},_.useEffect=function(t,e){return a.current.useEffect(t,e)},_.useId=function(){return a.current.useId()},_.useImperativeHandle=function(t,e,r){return a.current.useImperativeHandle(t,e,r)},_.useInsertionEffect=function(t,e){return a.current.useInsertionEffect(t,e)},_.useLayoutEffect=function(t,e){return a.current.useLayoutEffect(t,e)},_.useMemo=function(t,e){return a.current.useMemo(t,e)},_.useReducer=function(t,e,r){return a.current.useReducer(t,e,r)},_.useRef=function(t){return a.current.useRef(t)},_.useState=function(t){return a.current.useState(t)},_.useSyncExternalStore=function(t,e,r){return a.current.useSyncExternalStore(t,e,r)},_.useTransition=function(){return a.current.useTransition()},_.version="18.2.0",O.exports=_;var se=O.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ne=se,_e=Symbol.for("react.element"),ue=Symbol.for("react.fragment"),le=Object.prototype.hasOwnProperty,fe=ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ce={key:!0,ref:!0,__self:!0,__source:!0};function U(t,e,r){var i,o={},s=null,n=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(n=e.ref);for(i in e)le.call(e,i)&&!ce.hasOwnProperty(i)&&(o[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)o[i]===void 0&&(o[i]=e[i]);return{$$typeof:_e,type:t,key:s,ref:n,props:o,_owner:fe.current}}b.Fragment=ue,b.jsx=U,b.jsxs=U;var h=(t=>(t.top_left="top_left",t.top_right="top_right",t.right="right",t.bottom_right="bottom_right",t.bottom_left="bottom_left",t.left="left",t))(h||{});function $(t){return Math.round(Math.sqrt(3)*t)}function q(t,e,r){const i=$(r);return[{x:t,y:e-r},{x:t+i/2,y:e-r/2},{x:t+i/2,y:e+r/2},{x:t,y:e+r},{x:t-i/2,y:e+r/2},{x:t-i/2,y:e-r/2}]}function ae(t,e,r){const i=$(r);return{top_left:{x:t-i/4,y:e-r*.75},top_right:{x:t+i/4,y:e-r*.75},right:{x:t+i/2,y:e},bottom_right:{x:t+i/4,y:e+r*.75},bottom_left:{x:t-i/4,y:e+r*.75},left:{x:t-i/2,y:e}}}const V={top_bar_height:2,top_bar_margin:.5,top_bar_padding:0,hex_grid_side_border:10,hex_grid_top_border:60,hex_grid_bottom_border:10};function he(t,e,r,i,o){const s=z(q(r,i,e));t.fillStyle=o,t.lineWidth=m.hexagon_stroke_width,t.strokeStyle=f.disabled,t.fill(s),t.stroke(s)}function z(t){const e=new Path2D;e.moveTo(t[0].x,t[0].y);for(let r=1;r<t.length;r++)e.lineTo(t[r].x,t[r].y);return e.closePath(),e}function p(t,e,r,i,o,s,n,l){n&&t.setLineDash(l),t.strokeStyle=s,t.lineCap="butt",t.lineWidth=10,t.fillStyle=s,t.beginPath(),t.arc(e,r,5,0,2*Math.PI),t.fill(),t.beginPath(),t.moveTo(e,r),t.lineTo(i,o),t.stroke()}function pe(t,e,r,i,o){t.fillStyle=o,t.beginPath(),t.arc(r,i,e,0,2*Math.PI),t.fill()}class de{constructor(e,r,i,o){u(this,"row_number");u(this,"column_number");u(this,"background_color_hexidecimal",f.white);u(this,"river_array",this.build_empty_path_dictionary());u(this,"road_array",this.build_empty_path_dictionary());u(this,"is_top_left_river",!1);u(this,"is_top_right_river",!1);u(this,"is_right_river",!1);u(this,"is_bottom_right_river",!1);u(this,"is_bottom_left_river",!1);u(this,"is_left_river",!1);u(this,"is_top_left_road",!1);u(this,"is_top_right_road",!1);u(this,"is_right_road",!1);u(this,"is_bottom_right_road",!1);u(this,"is_bottom_left_road",!1);u(this,"is_left_road",!1);u(this,"text","");u(this,"icon_name","");u(this,"edge_pixels");u(this,"canvas_context");u(this,"center_x");u(this,"center_y");this.row_number=e,this.column_number=r,this.edge_pixels=i,this.canvas_context=o;const s=$(this.edge_pixels),n=(this.row_number%2==1?s/2:0)+s/2+s*(this.column_number-1)+V.hex_grid_side_border,l=V.hex_grid_top_border+this.edge_pixels+this.edge_pixels*1.5*(this.row_number-1);this.center_x=n,this.center_y=l}clear_paths_from_hex(){}get_attribute_index_array(){const e=[];return e.push("another_background_color_hexidecimal"),e}get_serialized_attribute_index(e){}build_empty_path_dictionary(){return Object.fromEntries(Object.values(h).map(r=>[r,!1]))}populate_from_firebase_hex_data(e){const r=e.split("_");this.background_color_hexidecimal=r[0],this.is_top_left_river=r[1]=="1",this.is_top_right_river=r[2]=="1",this.is_right_river=r[3]=="1",this.is_bottom_right_river=r[4]=="1",this.is_bottom_left_river=r[5]=="1",this.is_left_river=r[6]=="1",this.is_top_left_road=r[7]=="1",this.is_top_right_road=r[8]=="1",this.is_right_road=r[9]=="1",this.is_bottom_right_road=r[10]=="1",this.is_bottom_left_road=r[11]=="1",this.is_left_road=r[12]=="1",this.text=r[13],this.icon_name=r[14]}get_firebase_hex_data(){return this.background_color_hexidecimal+"_"+(this.is_top_left_river?1:0)+"_"+(this.is_top_right_river?1:0)+"_"+(this.is_right_river?1:0)+"_"+(this.is_bottom_right_river?1:0)+"_"+(this.is_bottom_left_river?1:0)+"_"+(this.is_left_river?1:0)+"_"+(this.is_top_left_road?1:0)+"_"+(this.is_top_right_road?1:0)+"_"+(this.is_right_road?1:0)+"_"+(this.is_bottom_right_road?1:0)+"_"+(this.is_bottom_left_road?1:0)+"_"+(this.is_left_road?1:0)+"_"+this.text+"_"+this.icon_name}get_firebase_hex_key(){const r="0",i=this.row_number.toString().padStart(3,r),o=this.column_number.toString().padStart(3,r);return i+"_"+o}contains_point(e,r){let i=!1;return this.canvas_context&&this.canvas_context.isPointInPath(z(q(this.center_x,this.center_y,this.edge_pixels)),e,r)&&(i=!0),i}paint(){if(!this.canvas_context)return;he(this.canvas_context,this.edge_pixels,this.center_x,this.center_y,this.background_color_hexidecimal);const e=ae(this.center_x,this.center_y,this.edge_pixels);this.is_top_left_river&&p(this.canvas_context,this.center_x,this.center_y,e.top_left.x,e.top_left.y,f.ocean,!1,[this.edge_pixels/4]),this.is_top_right_river&&p(this.canvas_context,this.center_x,this.center_y,e.top_right.x,e.top_right.y,f.ocean,!1,[this.edge_pixels/4]),this.is_right_river&&p(this.canvas_context,this.center_x,this.center_y,e.right.x,e.right.y,f.ocean,!1,[this.edge_pixels/4]),this.is_bottom_right_river&&p(this.canvas_context,this.center_x,this.center_y,e.bottom_right.x,e.bottom_right.y,f.ocean,!1,[this.edge_pixels/4]),this.is_bottom_left_river&&p(this.canvas_context,this.center_x,this.center_y,e.bottom_left.x,e.bottom_left.y,f.ocean,!1,[this.edge_pixels/4]),this.is_left_river&&p(this.canvas_context,this.center_x,this.center_y,e.left.x,e.left.y,f.ocean,!1,[this.edge_pixels/4]),this.is_top_left_road&&p(this.canvas_context,this.center_x,this.center_y,e.top_left.x,e.top_left.y,f.road,!!this.is_top_left_river,[this.edge_pixels/4]),this.is_top_right_road&&p(this.canvas_context,this.center_x,this.center_y,e.top_right.x,e.top_right.y,f.road,!!this.is_top_right_river,[this.edge_pixels/4]),this.is_right_road&&p(this.canvas_context,this.center_x,this.center_y,e.right.x,e.right.y,f.road,!!this.is_right_river,[this.edge_pixels/4]),this.is_bottom_right_road&&p(this.canvas_context,this.center_x,this.center_y,e.bottom_right.x,e.bottom_right.y,f.road,!!this.is_bottom_right_river,[this.edge_pixels/4]),this.is_bottom_left_road&&p(this.canvas_context,this.center_x,this.center_y,e.bottom_left.x,e.bottom_left.y,f.road,!!this.is_bottom_left_river,[this.edge_pixels/4]),this.is_left_road&&p(this.canvas_context,this.center_x,this.center_y,e.left.x,e.left.y,f.road,!!this.is_left_river,[this.edge_pixels/4])}paint_temporary_circle(e){this.canvas_context&&pe(this.canvas_context,this.edge_pixels/2,this.center_x,this.center_y,e)}}class me{constructor(){u(this,"num_rows",m.num_hexes_tall);u(this,"num_columns",m.num_hexes_wide);u(this,"hexagons",[]);u(this,"firebase_map_doc",{});u(this,"hexagon_edge_pixels",m.hexagon_edge_pixels);u(this,"canvas_context");u(this,"neighbor_options",["top left","top right","right","bottom right","bottom left","left"])}are_neighbors(e,r){let i=!1;return this.get_all_neighbors(e).forEach(s=>{s==r&&(i=!0)}),i}is_pushed_right_row(e){return e%2==1}get_all_neighbors(e){const r=[];return Object.values(h).forEach(o=>{const s=this.get_neighbor(e,o);s&&r.push(s)}),r}get_neighbor(e,r){let i;const o=this.is_pushed_right_row(e.row_number);let s=e.row_number,n=e.column_number;return[h.top_left,h.top_right].includes(r)?s+=1:[h.bottom_right,h.bottom_left].includes(r)&&(s-=1),r==h.right||[h.top_right,h.bottom_right].includes(r)&&o?n+=1:(r==h.left||[h.top_left,h.bottom_left].includes(r)&&!o)&&(n-=1),s>0&&s<=this.num_rows&&n>0&&n<=this.num_columns&&(i=this.get_hexagon(s,n)),i}set_context(e){this.canvas_context=e}resize(e,r,i){this.hexagon_edge_pixels=e,this.num_rows=r||this.num_rows,this.num_columns=i||this.num_columns}update_matrix_from_firebase_doc(e){this.hexagons.forEach(function(r){const i=r.get_firebase_hex_key(),o=e[i],s=r.get_firebase_hex_data();o!=null&&o!=s&&(r.populate_from_firebase_hex_data(o),r.paint())})}populate_matrix(e){this.hexagons=[],e&&(this.firebase_map_doc=e),this.firebase_map_doc&&(this.firebase_map_doc.height&&(this.num_rows=parseInt(this.firebase_map_doc.height)),this.firebase_map_doc.width&&(this.num_columns=parseInt(this.firebase_map_doc.width)));for(let r=1;r<=this.num_rows;r++)for(let i=1;i<=this.num_columns;i++){const o=new de(r,i,this.hexagon_edge_pixels,this.canvas_context);if(this.firebase_map_doc){const s=o.get_firebase_hex_key(),n=this.firebase_map_doc[s];n!=null&&o.populate_from_firebase_hex_data(n)}this.hexagons.push(o)}}get_firebase_map_doc(){if(this.firebase_map_doc)return this.firebase_map_doc;{const e={height:this.num_rows,width:this.num_columns};return this.hexagons.forEach(r=>{e[r.get_firebase_hex_key()]=r.get_firebase_hex_data()}),e}}paint_hexagons(){this.hexagons.forEach(e=>e.paint())}get_hexagon(e,r){let i;for(let o=0;o<this.hexagons.length;o++){const s=this.hexagons[o];s.row_number==e&&s.column_number==r&&(i=s)}return i}add_path(e,r,i){e.row_number==r.row_number&&e.column_number==r.column_number||(e.row_number==r.row_number?r.column_number>e.column_number?i=="river"?(e.is_right_river=!0,r.is_left_river=!0):i=="road"&&(e.is_right_road=!0,r.is_left_road=!0):i=="river"?(e.is_left_river=!0,r.is_right_river=!0):i=="road"&&(e.is_left_road=!0,r.is_right_road=!0):r.row_number<e.row_number?e.row_number%2==1?r.column_number==e.column_number?i=="river"?(e.is_top_left_river=!0,r.is_bottom_right_river=!0):i=="road"&&(e.is_top_left_road=!0,r.is_bottom_right_road=!0):i=="river"?(e.is_top_right_river=!0,r.is_bottom_left_river=!0):i=="road"&&(e.is_top_right_road=!0,r.is_bottom_left_road=!0):r.column_number==e.column_number?i=="river"?(e.is_top_right_river=!0,r.is_bottom_left_river=!0):i=="road"&&(e.is_top_right_road=!0,r.is_bottom_left_road=!0):i=="river"?(e.is_top_left_river=!0,r.is_bottom_right_river=!0):i=="road"&&(e.is_top_left_road=!0,r.is_bottom_right_road=!0):e.row_number%2==1?r.column_number==e.column_number?i=="river"?(e.is_bottom_left_river=!0,r.is_top_right_river=!0):i=="road"&&(e.is_bottom_left_road=!0,r.is_top_right_road=!0):i=="river"?(e.is_bottom_right_river=!0,r.is_top_left_river=!0):i=="road"&&(e.is_bottom_right_road=!0,r.is_top_left_road=!0):r.column_number==e.column_number?i=="river"?(e.is_bottom_right_river=!0,r.is_top_left_river=!0):i=="road"&&(e.is_bottom_right_road=!0,r.is_top_left_road=!0):i=="river"?(e.is_bottom_left_river=!0,r.is_top_right_river=!0):i=="road"&&(e.is_bottom_left_road=!0,r.is_top_right_road=!0))}}onmessage=t=>{const e=t.data.firebase_map_doc,r=t.data.canvas_height_pixels,i=t.data.canvas_width_pixels,o=t.data.hexagon_edge_pixels,s=new OffscreenCanvas(i,r),n=s.getContext("2d"),l=new me;l.resize(o),l.set_context(n),l.populate_matrix(e),l.paint_hexagons(),postMessage({bitmap:s.transferToImageBitmap()})}})();
