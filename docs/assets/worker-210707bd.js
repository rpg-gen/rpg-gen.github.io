var Re=Object.defineProperty;var Pe=(m,l,y)=>l in m?Re(m,l,{enumerable:!0,configurable:!0,writable:!0,value:y}):m[l]=y;var h=(m,l,y)=>(Pe(m,typeof l!="symbol"?l+"":l,y),y);(function(){"use strict";const m={num_hexes_tall:10,num_hexes_wide:10,hexagon_edge_pixels:80,zoom_level:5,brush_id:"river",hexagon_stroke_width:1,daily_word_goal:2e3,torch_animation_base_timing:6},l={unset:"#FFFFFF",ocean:"#a5c6fa",mountain:"#9d9fa1",bog:"#ffe4fd",forest:"#a1e070",plains:"#ddfec3",desert:"#fae4a7",hills:"#d1d2d3",white:"#ffffff",black:"#000000",road:"#dc9e00",red:"#a83232",disabled:"#c2c2c2"};var y={},$={exports:{}},a={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x=Symbol.for("react.element"),Y=Symbol.for("react.portal"),K=Symbol.for("react.fragment"),X=Symbol.for("react.strict_mode"),Z=Symbol.for("react.profiler"),ee=Symbol.for("react.provider"),te=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),ie=Symbol.for("react.suspense"),ne=Symbol.for("react.memo"),oe=Symbol.for("react.lazy"),T=Symbol.iterator;function se(e){return e===null||typeof e!="object"?null:(e=T&&e[T]||e["@@iterator"],typeof e=="function"?e:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z=Object.assign,D={};function b(e,t,r){this.props=e,this.context=t,this.refs=D,this.updater=r||I}b.prototype.isReactComponent={},b.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},b.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=b.prototype;function E(e,t,r){this.props=e,this.context=t,this.refs=D,this.updater=r||I}var S=E.prototype=new F;S.constructor=E,z(S,b.prototype),S.isPureReactComponent=!0;var L=Array.isArray,M=Object.prototype.hasOwnProperty,O={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function N(e,t,r){var i,n={},o=null,s=null;if(t!=null)for(i in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)M.call(t,i)&&!A.hasOwnProperty(i)&&(n[i]=t[i]);var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){for(var u=Array(c),g=0;g<c;g++)u[g]=arguments[g+2];n.children=u}if(e&&e.defaultProps)for(i in c=e.defaultProps,c)n[i]===void 0&&(n[i]=c[i]);return{$$typeof:x,type:e,key:o,ref:s,props:n,_owner:O.current}}function ae(e,t){return{$$typeof:x,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function j(e){return typeof e=="object"&&e!==null&&e.$$typeof===x}function _e(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var U=/\/+/g;function R(e,t){return typeof e=="object"&&e!==null&&e.key!=null?_e(""+e.key):t.toString(36)}function v(e,t,r,i,n){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case x:case Y:s=!0}}if(s)return s=e,n=n(s),e=i===""?"."+R(s,0):i,L(n)?(r="",e!=null&&(r=e.replace(U,"$&/")+"/"),v(n,t,r,"",function(g){return g})):n!=null&&(j(n)&&(n=ae(n,r+(!n.key||s&&s.key===n.key?"":(""+n.key).replace(U,"$&/")+"/")+e)),t.push(n)),1;if(s=0,i=i===""?".":i+":",L(e))for(var c=0;c<e.length;c++){o=e[c];var u=i+R(o,c);s+=v(o,t,r,u,n)}else if(u=se(e),typeof u=="function")for(e=u.call(e),c=0;!(o=e.next()).done;)o=o.value,u=i+R(o,c++),s+=v(o,t,r,u,n);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function k(e,t,r){if(e==null)return e;var i=[],n=0;return v(e,i,"","",function(o){return t.call(r,o,n++)}),i}function ce(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var d={current:null},w={transition:null},le={ReactCurrentDispatcher:d,ReactCurrentBatchConfig:w,ReactCurrentOwner:O};a.Children={map:k,forEach:function(e,t,r){k(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return k(e,function(){t++}),t},toArray:function(e){return k(e,function(t){return t})||[]},only:function(e){if(!j(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},a.Component=b,a.Fragment=K,a.Profiler=Z,a.PureComponent=E,a.StrictMode=X,a.Suspense=ie,a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=le,a.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=z({},e.props),n=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=O.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)M.call(t,u)&&!A.hasOwnProperty(u)&&(i[u]=t[u]===void 0&&c!==void 0?c[u]:t[u])}var u=arguments.length-2;if(u===1)i.children=r;else if(1<u){c=Array(u);for(var g=0;g<u;g++)c[g]=arguments[g+2];i.children=c}return{$$typeof:x,type:e.type,key:n,ref:o,props:i,_owner:s}},a.createContext=function(e){return e={$$typeof:te,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ee,_context:e},e.Consumer=e},a.createElement=N,a.createFactory=function(e){var t=N.bind(null,e);return t.type=e,t},a.createRef=function(){return{current:null}},a.forwardRef=function(e){return{$$typeof:re,render:e}},a.isValidElement=j,a.lazy=function(e){return{$$typeof:oe,_payload:{_status:-1,_result:e},_init:ce}},a.memo=function(e,t){return{$$typeof:ne,type:e,compare:t===void 0?null:t}},a.startTransition=function(e){var t=w.transition;w.transition={};try{e()}finally{w.transition=t}},a.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},a.useCallback=function(e,t){return d.current.useCallback(e,t)},a.useContext=function(e){return d.current.useContext(e)},a.useDebugValue=function(){},a.useDeferredValue=function(e){return d.current.useDeferredValue(e)},a.useEffect=function(e,t){return d.current.useEffect(e,t)},a.useId=function(){return d.current.useId()},a.useImperativeHandle=function(e,t,r){return d.current.useImperativeHandle(e,t,r)},a.useInsertionEffect=function(e,t){return d.current.useInsertionEffect(e,t)},a.useLayoutEffect=function(e,t){return d.current.useLayoutEffect(e,t)},a.useMemo=function(e,t){return d.current.useMemo(e,t)},a.useReducer=function(e,t,r){return d.current.useReducer(e,t,r)},a.useRef=function(e){return d.current.useRef(e)},a.useState=function(e){return d.current.useState(e)},a.useSyncExternalStore=function(e,t,r){return d.current.useSyncExternalStore(e,t,r)},a.useTransition=function(){return d.current.useTransition()},a.version="18.2.0",$.exports=a;var ue=$.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var he=ue,fe=Symbol.for("react.element"),de=Symbol.for("react.fragment"),pe=Object.prototype.hasOwnProperty,ge=he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,me={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,r){var i,n={},o=null,s=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(i in t)pe.call(t,i)&&!me.hasOwnProperty(i)&&(n[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)n[i]===void 0&&(n[i]=t[i]);return{$$typeof:fe,type:e,key:o,ref:s,props:n,_owner:ge.current}}y.Fragment=de,y.jsx=q,y.jsxs=q;var _=(e=>(e.top_left="top_left",e.top_right="top_right",e.right="right",e.bottom_right="bottom_right",e.bottom_left="bottom_left",e.left="left",e))(_||{});function P(e){return Math.round(Math.sqrt(3)*e)}function H(e,t,r){const i=P(r);return[{x:e,y:t-r},{x:e+i/2,y:t-r/2},{x:e+i/2,y:t+r/2},{x:e,y:t+r},{x:e-i/2,y:t+r/2},{x:e-i/2,y:t-r/2}]}function ye(e,t,r){const i=P(r);return{[_.top_left]:{x:e-i/4,y:t-r*.75},[_.top_right]:{x:e+i/4,y:t-r*.75},[_.right]:{x:e+i/2,y:t},[_.bottom_right]:{x:e+i/4,y:t+r*.75},[_.bottom_left]:{x:e-i/4,y:t+r*.75},[_.left]:{x:e-i/2,y:t}}}function V(e){switch(e){case _.top_left:return _.bottom_right;case _.top_right:return _.bottom_left;case _.right:return _.left;case _.bottom_right:return _.top_left;case _.bottom_left:return _.top_right;default:return _.right}}const B={top_bar_height:2,top_bar_margin:.5,top_bar_padding:0,hex_grid_side_border:10,hex_grid_top_border:60,hex_grid_bottom_border:10};function be(e,t,r,i,n){const o=W(H(r,i,t));e.fillStyle=n,e.lineWidth=m.hexagon_stroke_width,e.strokeStyle=l.disabled,e.fill(o),e.stroke(o)}function W(e){const t=new Path2D;t.moveTo(e[0].x,e[0].y);for(let r=1;r<e.length;r++)t.lineTo(e[r].x,e[r].y);return t.closePath(),t}function xe(e,t,r,i,n,o,s,c){s?e.setLineDash(c):e.setLineDash([]),e.strokeStyle=o,e.lineCap="butt",e.lineWidth=10,e.fillStyle=o,e.beginPath(),e.arc(t,r,5,0,2*Math.PI),e.fill(),e.beginPath(),e.moveTo(t,r),e.lineTo(i,n),e.stroke()}function ve(e,t,r,i,n){e.fillStyle=n,e.beginPath(),e.arc(r,i,t,0,2*Math.PI),e.fill()}var p=(e=>(e.light="light",e.dark="dark",e))(p||{}),f=(e=>(e.background="background",e.action="action",e.icon="icon",e.path="path",e))(f||{}),ke="/assets/magnifying_glass-693b3045.svg",G="/assets/unset-a23ddb11.svg",C="/assets/village-6ef3b802.svg",we="/assets/river-fea23e0a.svg",Ee="/assets/road-d0fb0daa.svg";const J={query:{id:"query",display_name:"Query",description:"",paint_category:f.action,hotkey:"u",hexidecimal_color:l.white,color_type:p.light,icon:ke,dark_icon:null,light_icon:null},unset:{id:"unset",display_name:"Unset",description:"Remove the biome background",paint_category:f.background,hotkey:"u",hexidecimal_color:l.unset,color_type:p.light,icon:null,dark_icon:null,light_icon:null},ocean:{id:"ocean",display_name:"Ocean",description:"Large body of water",paint_category:f.background,hotkey:"u",hexidecimal_color:l.ocean,color_type:p.light,icon:null,dark_icon:null,light_icon:null},mountain:{id:"mountain",display_name:"Mountain",description:"Tall Peaks, steep slopes",paint_category:f.background,hotkey:"u",hexidecimal_color:l.mountain,color_type:p.light,icon:null,dark_icon:null,light_icon:null},bog:{id:"bog",display_name:"Bog",description:"Wetlands, marshes, swamp",paint_category:f.background,hotkey:"u",hexidecimal_color:l.bog,color_type:p.light,icon:null,dark_icon:null,light_icon:null},plains:{id:"plains",display_name:"Plains",description:"Flatlands, prairie, fields, open areas",paint_category:f.background,hotkey:"u",hexidecimal_color:l.plains,color_type:p.light,icon:null,dark_icon:null,light_icon:null},forest:{id:"forest",display_name:"Forest",description:"High tree density or plant growth",paint_category:f.background,hotkey:"u",hexidecimal_color:l.forest,color_type:p.light,icon:null,dark_icon:null,light_icon:null},desert:{id:"desert",display_name:"Desert",description:"Barren, dry, wasteland, or minimal vegetation",paint_category:f.background,hotkey:"u",hexidecimal_color:l.desert,color_type:p.light,icon:null,dark_icon:null,light_icon:null},hills:{id:"hills",display_name:"Hills",description:"Mellow slopes, rolling hills, highlands",paint_category:f.background,hotkey:"u",hexidecimal_color:l.hills,color_type:p.light,icon:null,dark_icon:null,light_icon:null},town:{id:"town",display_name:"Town",description:"Mid-sized settlement",paint_category:f.icon,hotkey:"u",hexidecimal_color:l.white,color_type:p.light,icon:C,dark_icon:C,light_icon:C},clear_icon:{id:"clear_icon",display_name:"Clear",description:"Remove icon",paint_category:f.icon,hotkey:"u",hexidecimal_color:l.white,color_type:p.light,icon:G,dark_icon:null,light_icon:null},river:{id:"river",display_name:"River",description:"Click neighboring hexes to draw waterways",paint_category:f.path,hotkey:"u",hexidecimal_color:l.ocean,color_type:p.light,icon:we,dark_icon:null,light_icon:null},road:{id:"road",display_name:"Road",description:"Click neighboring hexes to draw roads",paint_category:f.path,hotkey:"u",hexidecimal_color:l.road,color_type:p.light,icon:Ee,dark_icon:null,light_icon:null},clear_path:{id:"clear_path",display_name:"Clear",description:"Remove all paths from this hex",paint_category:f.path,hotkey:"u",hexidecimal_color:l.white,color_type:p.light,icon:G,dark_icon:null,light_icon:null}};class Se{constructor(t,r,i,n){h(this,"row_number");h(this,"column_number");h(this,"background_color_hexidecimal",l.white);h(this,"path_dictionaries",this.build_empty_path_dictionaries());h(this,"text","");h(this,"icon_name","");h(this,"firebase_serialization_indexes",this.get_firebase_serialization_indexes());h(this,"edge_pixels");h(this,"canvas_context");h(this,"center_x");h(this,"center_y");this.row_number=t,this.column_number=r,this.edge_pixels=i,this.canvas_context=n;const o=P(this.edge_pixels),s=(this.row_number%2==1?o/2:0)+o/2+o*(this.column_number-1)+B.hex_grid_side_border,c=B.hex_grid_top_border+this.edge_pixels+this.edge_pixels*1.5*(this.row_number-1);this.center_x=s,this.center_y=c}clear_paths(t){t?Object.keys(this.path_dictionaries).forEach(r=>{this.path_dictionaries[r][t]=!1}):this.path_dictionaries=this.build_empty_path_dictionaries()}get_path_brushes(){return Object.entries(J).filter(t=>{const r=t[1];return r.paint_category==f.path&&r.id!="clear_path"})}build_empty_path_dictionaries(){const t=this.get_path_brushes(),r={};return t.forEach(i=>{r[i[0]]=Object.fromEntries(Object.values(_).map(n=>[n,!1]))}),r}get_firebase_serialization_indexes(){const t=[];return t.push("background_color_hexidecimal"),t.push("text"),t.push("icon_name"),Object.keys(this.path_dictionaries).forEach(r=>{Object.keys(this.path_dictionaries[r]).forEach(i=>{t.push(this.get_path_attribute_key(r,i))})}),t}get_path_attribute_key(t,r){return t+"_"+r}get_firebase_serialization_index(t){let r=0;return this.firebase_serialization_indexes.forEach((i,n)=>{i==t&&(r=n)}),r}populate_from_firebase_hex_data(t){const r=t.split("_");this.background_color_hexidecimal=r[this.get_firebase_serialization_index("background_color_hexidecimal")],this.text=r[this.get_firebase_serialization_index("text")],this.icon_name=r[this.get_firebase_serialization_index("icon_name")],Object.keys(this.path_dictionaries).forEach(i=>{Object.values(_).forEach(n=>{const o=r[this.get_firebase_serialization_index(this.get_path_attribute_key(i,n))];this.path_dictionaries[i][n]=o=="1"})})}get_firebase_hex_data(){let t=[];return t.push([this.get_firebase_serialization_index("background_color_hexidecimal"),this.background_color_hexidecimal]),t.push([this.get_firebase_serialization_index("text"),this.text]),t.push([this.get_firebase_serialization_index("icon_name"),this.icon_name]),Object.keys(this.path_dictionaries).forEach(i=>{Object.values(_).forEach(n=>{const o=this.get_firebase_serialization_index(this.get_path_attribute_key(i,n)),s=this.path_dictionaries[i][n]==!0?"1":"0";t.push([o,s])})}),t.sort((i,n)=>i[0]<n[0]?-1:1),t.map(i=>i[1]).join("_")}get_firebase_hex_key(){const r="0",i=this.row_number.toString().padStart(3,r),n=this.column_number.toString().padStart(3,r);return i+"_"+n}contains_point(t,r){let i=!1;return this.canvas_context&&this.canvas_context.isPointInPath(W(H(this.center_x,this.center_y,this.edge_pixels)),t,r)&&(i=!0),i}paint(){if(!this.canvas_context)return;const t=this.canvas_context;be(this.canvas_context,this.edge_pixels,this.center_x,this.center_y,this.background_color_hexidecimal);const r=ye(this.center_x,this.center_y,this.edge_pixels);Object.entries(this.path_dictionaries).forEach(i=>{const n=i[0],o=i[1];Object.values(_).forEach(s=>{const c=s,u=o[s],g=r[c],je=[this.edge_pixels/4];let Q=!1;n=="road"&&this.path_dictionaries.river[c]&&(Q=!0),u&&xe(t,this.center_x,this.center_y,g.x,g.y,J[n].hexidecimal_color,Q,je)})})}paint_temporary_circle(t){this.canvas_context&&ve(this.canvas_context,this.edge_pixels/2,this.center_x,this.center_y,t)}}class Oe{constructor(){h(this,"num_rows",m.num_hexes_tall);h(this,"num_columns",m.num_hexes_wide);h(this,"hexagons",[]);h(this,"firebase_map_doc",{});h(this,"hexagon_edge_pixels",m.hexagon_edge_pixels);h(this,"canvas_context")}are_neighbors(t,r){let i=!1;return this.get_all_neighbors(t).forEach(o=>{o==r&&(i=!0)}),i}is_pushed_right_row(t){return t%2==1}get_all_neighbors(t){const r=[];return Object.values(_).forEach(n=>{const o=this.get_neighbor(t,n);o&&r.push(o)}),r}get_neighbor(t,r){let i;const n=this.is_pushed_right_row(t.row_number);let o=t.row_number,s=t.column_number;return[_.top_left,_.top_right].includes(r)?o-=1:[_.bottom_right,_.bottom_left].includes(r)&&(o+=1),r==_.right||[_.top_right,_.bottom_right].includes(r)&&n?s+=1:(r==_.left||[_.top_left,_.bottom_left].includes(r)&&!n)&&(s-=1),o>0&&o<=this.num_rows&&s>0&&s<=this.num_columns&&(i=this.get_hexagon(o,s)),i}get_neighbor_direction(t,r){const n=Object.values(_).find(o=>{const s=this.get_neighbor(t,o);if(s){const c=s.get_firebase_hex_key();return r.get_firebase_hex_key()==c}});if(!n)throw new Error("Unable to get neighbor direction, Possibly attempting with non-neighbors");return n}add_path(t,r,i){const n=this.get_neighbor_direction(t,r);if(!this.are_neighbors(t,r))throw new Error("Attempted to add a path between hexes that are not neighbors");const o=V(n);t.path_dictionaries[i][n]=!0,r.path_dictionaries[i][o]=!0}remove_paths(t){t.clear_paths(),Object.values(_).forEach(r=>{const i=this.get_neighbor(t,r);if(i){const n=V(r);i.clear_paths(n)}})}set_context(t){this.canvas_context=t}resize(t,r,i){this.hexagon_edge_pixels=t,this.num_rows=r||this.num_rows,this.num_columns=i||this.num_columns}update_matrix_from_firebase_doc(t){this.hexagons.forEach(function(r){const i=r.get_firebase_hex_key(),n=t[i],o=r.get_firebase_hex_data();n!=null&&n!=o&&(r.populate_from_firebase_hex_data(n),r.paint())})}populate_matrix(t){this.hexagons=[],t&&(this.firebase_map_doc=t),this.firebase_map_doc&&(this.firebase_map_doc.height&&(this.num_rows=parseInt(this.firebase_map_doc.height)),this.firebase_map_doc.width&&(this.num_columns=parseInt(this.firebase_map_doc.width)));for(let r=1;r<=this.num_rows;r++)for(let i=1;i<=this.num_columns;i++){const n=new Se(r,i,this.hexagon_edge_pixels,this.canvas_context);if(this.firebase_map_doc){const o=n.get_firebase_hex_key(),s=this.firebase_map_doc[o];s!=null&&n.populate_from_firebase_hex_data(s)}this.hexagons.push(n)}}get_firebase_map_doc(){if(this.firebase_map_doc)return this.firebase_map_doc;{const t={height:this.num_rows,width:this.num_columns};return this.hexagons.forEach(r=>{t[r.get_firebase_hex_key()]=r.get_firebase_hex_data()}),t}}paint_hexagons(){this.hexagons.forEach(t=>t.paint())}get_hexagon(t,r){let i;for(let n=0;n<this.hexagons.length;n++){const o=this.hexagons[n];o.row_number==t&&o.column_number==r&&(i=o)}return i}}onmessage=e=>{const t=e.data.firebase_map_doc,r=e.data.canvas_height_pixels,i=e.data.canvas_width_pixels,n=e.data.hexagon_edge_pixels,o=new OffscreenCanvas(i,r),s=o.getContext("2d"),c=new Oe;c.resize(n),c.set_context(s),c.populate_matrix(t),c.paint_hexagons(),postMessage({bitmap:o.transferToImageBitmap()})}})();
